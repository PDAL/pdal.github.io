<!DOCTYPE html><html>
<head>
    <meta http-equiv="Content-Type"
          content="text/html; charset=utf-8"/>
    
        <title>libLAS C API to PDAL transition guide &mdash; pdal.io</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='http://fonts.googleapis.com/css?family=Crete+Round' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="../_static/sphinx-bootstrap.css" type="text/css"/>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css"/>
        <link rel="stylesheet" href="../_static/breathe.css" type="text/css"/>
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
        <script type="text/javascript">
            var DOCUMENTATION_OPTIONS = {
                URL_ROOT:'../',
                VERSION:'1.0.1',
                COLLAPSE_INDEX:false,
                FILE_SUFFIX:'.html',
                HAS_SOURCE:  true
            };
        </script>
            <script type="text/javascript" src="../_static/jquery.js"></script>
            <script type="text/javascript" src="../_static/underscore.js"></script>
            <script type="text/javascript" src="../_static/doctools.js"></script>
            <script type="text/javascript" src="../_static/bootstrap-dropdown.js"></script> 
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
    
        <!-- analytics -->
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-00000000-1']);
            
            _gaq.push(['_trackPageview']);

            (function () {
                var ga = document.createElement('script');
                ga.type = 'text/javascript';
                ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(ga, s);
            })();
        </script>
    
</head>
<body>

    <div class="navbar navbar-static-top">
        <div class="navbar-inner">
            <div class="container">
                        <a href="../index.html">
                            <img class="logo" src="../_static/pdal_logo.png"
                            
                            
                            alt="PDAL" title="PDAL"/>
                        </a>


                <ul class="quick-links">
                    <li>
                        <a href="../docs.html" title="Documentation">Docs</a> 
                    </li>
                    <li class="divider">&middot;</li>
                    <li>
                        <a href="https://github.com/PDAL/PDAL/">github</a>
                    </li>
                    <li class="divider">&middot;</li>
                    <li>
                        <a href="https://github.com/PDAL/PDAL/issues">Bugs</a>
                    </li>
                    <li class="divider">&middot;</li>
                    <li>
                        <a href="../faq.html" title="FAQ">FAQ</a> 
                    </li>
                    <li class="divider">&middot;</li>

                    <li>
                        <a href="../download.html" title="Home">Download</a>
                    </li>
                    <li class="divider">&middot;</li>

                    <li>
                        <a href="../community.html" title="Mailing Lists">Mailing Lists</a>
                    </li>

                </ul>

            </div>
        </div>
    </div>
  
    <div class="container">
        <div class="content row">
                <div class="span9">
                    
  <div class="section" id="liblas-c-api-to-pdal-transition-guide">
<span id="liblas-to-pdal"></span><h1>libLAS C API to PDAL transition guide<a class="headerlink" href="#liblas-c-api-to-pdal-transition-guide" title="Permalink to this headline">¶</a></h1>
<p>This page shows how to port code using libLAS C API to PDAL API
(which is C++). The new code is not using full power of PDAL but
it uses just what is necessary to read content of a LAS file.</p>
<div class="section" id="includes">
<h2>Includes<a class="headerlink" href="#includes" title="Permalink to this headline">¶</a></h2>
<p>libLAS include:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &lt;liblas/capi/liblas.h&gt;</span>
</pre></div>
</div>
<p>For PDAL, in addition to PDAL headers, we also include standard headers
which will be useful later:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &lt;memory&gt;</span>
<span class="cp">#include &lt;pdal/PointTable.hpp&gt;</span>
<span class="cp">#include &lt;pdal/PointView.hpp&gt;</span>
<span class="cp">#include &lt;pdal/LasReader.hpp&gt;</span>
<span class="cp">#include &lt;pdal/LasHeader.hpp&gt;</span>
<span class="cp">#include &lt;pdal/Options.hpp&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="initial-steps">
<h2>Initial steps<a class="headerlink" href="#initial-steps" title="Permalink to this headline">¶</a></h2>
<p>Opening the dataset in libLAS:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">LASReaderH</span> <span class="n">LAS_reader</span><span class="p">;</span>
<span class="n">LASHeaderH</span> <span class="n">LAS_header</span><span class="p">;</span>
<span class="n">LASSRSH</span> <span class="n">LAS_srs</span><span class="p">;</span>
<span class="n">LAS_reader</span> <span class="o">=</span> <span class="n">LASReader_Create</span><span class="p">(</span><span class="n">in_opt</span><span class="o">-&gt;</span><span class="n">answer</span><span class="p">);</span>
<span class="n">LAS_header</span> <span class="o">=</span> <span class="n">LASReader_GetHeader</span><span class="p">(</span><span class="n">LAS_reader</span><span class="p">);</span>
</pre></div>
</div>
<p>The higher level of abstraction in PDAL requires a little bit more code
for the initial steps:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">pdal</span><span class="o">::</span><span class="n">Option</span> <span class="n">las_opt</span><span class="p">(</span><span class="s">&quot;filename&quot;</span><span class="p">,</span> <span class="n">in_opt</span><span class="o">-&gt;</span><span class="n">answer</span><span class="p">);</span>
<span class="n">pdal</span><span class="o">::</span><span class="n">Options</span> <span class="n">las_opts</span><span class="p">;</span>
<span class="n">las_opts</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">las_opt</span><span class="p">);</span>
<span class="n">pdal</span><span class="o">::</span><span class="n">PointTable</span> <span class="n">table</span><span class="p">;</span>
<span class="n">pdal</span><span class="o">::</span><span class="n">LasReader</span> <span class="n">las_reader</span><span class="p">;</span>
<span class="n">las_reader</span><span class="p">.</span><span class="n">setOptions</span><span class="p">(</span><span class="n">las_opts</span><span class="p">);</span>
<span class="n">las_reader</span><span class="p">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">table</span><span class="p">);</span>
<span class="n">pdal</span><span class="o">::</span><span class="n">PointViewSet</span> <span class="n">point_view_set</span> <span class="o">=</span> <span class="n">las_reader</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">table</span><span class="p">);</span>
<span class="n">pdal</span><span class="o">::</span><span class="n">PointViewPtr</span> <span class="n">point_view</span> <span class="o">=</span> <span class="o">*</span><span class="n">point_view_set</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
<span class="n">pdal</span><span class="o">::</span><span class="n">Dimension</span><span class="o">::</span><span class="n">IdList</span> <span class="n">dims</span> <span class="o">=</span> <span class="n">point_view</span><span class="o">-&gt;</span><span class="n">dims</span><span class="p">();</span>
<span class="n">pdal</span><span class="o">::</span><span class="n">LasHeader</span> <span class="n">las_header</span> <span class="o">=</span> <span class="n">las_reader</span><span class="p">.</span><span class="n">header</span><span class="p">();</span>
</pre></div>
</div>
<p>The PDAL code is also different in the way that we read all the data
right away while in libLAS we just open the file.
To make use of other readers supported by PDAL, see <tt class="docutils literal"><span class="pre">StageFactory</span></tt> class.</p>
<p>The test if the file was loaded successfully, the test of the header
pointer was used with libLAS:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="n">LAS_header</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* fail */</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In general, PDAL will throw a <tt class="docutils literal"><span class="pre">pdal_error</span></tt> exception in case something
is wrong and it can&#8217;t recover such in the case when the file can&#8217;t be opened.
To handle the exceptional state by yourself, you can wrap the code
in <tt class="docutils literal"><span class="pre">try-catch</span></tt> block:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">try</span> <span class="p">{</span>
    <span class="cm">/* actual code */</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
    <span class="cm">/* fail in your own way */</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="dataset-properties">
<h2>Dataset properties<a class="headerlink" href="#dataset-properties" title="Permalink to this headline">¶</a></h2>
<p>We assume we defined all the following variables as <tt class="docutils literal"><span class="pre">double</span></tt>.</p>
<p>The general properties from the LAS file are retrieved from the
header in libLAS:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">scale_x</span> <span class="o">=</span> <span class="n">LASHeader_GetScaleX</span><span class="p">(</span><span class="n">LAS_header</span><span class="p">);</span>
<span class="n">scale_y</span> <span class="o">=</span> <span class="n">LASHeader_GetScaleY</span><span class="p">(</span><span class="n">LAS_header</span><span class="p">);</span>
<span class="n">scale_z</span> <span class="o">=</span> <span class="n">LASHeader_GetScaleZ</span><span class="p">(</span><span class="n">LAS_header</span><span class="p">);</span>

<span class="n">offset_x</span> <span class="o">=</span> <span class="n">LASHeader_GetOffsetX</span><span class="p">(</span><span class="n">LAS_header</span><span class="p">);</span>
<span class="n">offset_y</span> <span class="o">=</span> <span class="n">LASHeader_GetOffsetY</span><span class="p">(</span><span class="n">LAS_header</span><span class="p">);</span>
<span class="n">offset_z</span> <span class="o">=</span> <span class="n">LASHeader_GetOffsetZ</span><span class="p">(</span><span class="n">LAS_header</span><span class="p">);</span>

<span class="n">xmin</span> <span class="o">=</span> <span class="n">LASHeader_GetMinX</span><span class="p">(</span><span class="n">LAS_header</span><span class="p">);</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="n">LASHeader_GetMaxX</span><span class="p">(</span><span class="n">LAS_header</span><span class="p">);</span>
<span class="n">ymin</span> <span class="o">=</span> <span class="n">LASHeader_GetMinY</span><span class="p">(</span><span class="n">LAS_header</span><span class="p">);</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="n">LASHeader_GetMaxY</span><span class="p">(</span><span class="n">LAS_header</span><span class="p">);</span>
</pre></div>
</div>
<p>And the same applies PDAL:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">scale_x</span> <span class="o">=</span> <span class="n">las_header</span><span class="p">.</span><span class="n">scaleX</span><span class="p">();</span>
<span class="n">scale_y</span> <span class="o">=</span> <span class="n">las_header</span><span class="p">.</span><span class="n">scaleY</span><span class="p">();</span>
<span class="n">scale_z</span> <span class="o">=</span> <span class="n">las_header</span><span class="p">.</span><span class="n">scaleZ</span><span class="p">();</span>

<span class="n">offset_x</span> <span class="o">=</span> <span class="n">las_header</span><span class="p">.</span><span class="n">offsetX</span><span class="p">();</span>
<span class="n">offset_y</span> <span class="o">=</span> <span class="n">las_header</span><span class="p">.</span><span class="n">offsetY</span><span class="p">();</span>
<span class="n">offset_z</span> <span class="o">=</span> <span class="n">las_header</span><span class="p">.</span><span class="n">offsetZ</span><span class="p">();</span>

<span class="n">xmin</span> <span class="o">=</span> <span class="n">las_header</span><span class="p">.</span><span class="n">minX</span><span class="p">();</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="n">las_header</span><span class="p">.</span><span class="n">maxX</span><span class="p">();</span>
<span class="n">ymin</span> <span class="o">=</span> <span class="n">las_header</span><span class="p">.</span><span class="n">minY</span><span class="p">();</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="n">las_header</span><span class="p">.</span><span class="n">maxY</span><span class="p">();</span>
</pre></div>
</div>
<p>The point record count in libLAS:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n_features</span> <span class="o">=</span> <span class="n">LASHeader_GetPointRecordsCount</span><span class="p">(</span><span class="n">LAS_header</span><span class="p">);</span>
</pre></div>
</div>
<p>is just point count in PDAL:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n_features</span> <span class="o">=</span> <span class="n">las_header</span><span class="p">.</span><span class="n">pointCount</span><span class="p">();</span>
</pre></div>
</div>
<p>WKT of a spatial reference system is obtained from the header in libLAS:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">LAS_srs</span> <span class="o">=</span> <span class="n">LASHeader_GetSRS</span><span class="p">(</span><span class="n">LAS_header</span><span class="p">);</span>
<span class="kt">char</span><span class="o">*</span> <span class="n">projstr</span> <span class="o">=</span> <span class="n">LASSRS_GetWKT_CompoundOK</span><span class="p">(</span><span class="n">LAS_srs</span><span class="p">);</span>
</pre></div>
</div>
<p>In PDAL, spatial reference is part of the <tt class="docutils literal"><span class="pre">PointTable</span></tt>:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="kt">char</span><span class="o">*</span> <span class="n">projstr</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">spatialRef</span><span class="p">().</span><span class="n">getWKT</span><span class="p">(</span><span class="n">pdal</span><span class="o">::</span><span class="n">SpatialReference</span><span class="o">::</span><span class="n">eCompoundOK</span><span class="p">).</span><span class="n">c_str</span><span class="p">();</span>
</pre></div>
</div>
<p>Whether the time or color is supported by the LAS format, one would
have to determine from the format ID in libLAS:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">las_point_format</span> <span class="o">=</span> <span class="n">LASHeader_GetDataFormatId</span><span class="p">(</span><span class="n">LAS_header</span><span class="p">);</span>
<span class="n">have_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">las_point_format</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">...</span>
</pre></div>
</div>
<p>In PDAL, there is a convenient function for it in the header:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">have_time</span> <span class="o">=</span> <span class="n">las_header</span><span class="p">.</span><span class="n">hasTime</span><span class="p">();</span>
<span class="n">have_color</span> <span class="o">=</span> <span class="n">las_header</span><span class="p">.</span><span class="n">hasColor</span><span class="p">();</span>
</pre></div>
</div>
<p>The presence of color, time and other dimensions can be also determined
with:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">pdal</span><span class="o">::</span><span class="n">Dimension</span><span class="o">::</span><span class="n">IdList</span> <span class="n">dims</span> <span class="o">=</span> <span class="n">point_view</span><span class="o">-&gt;</span><span class="n">dims</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="iterating-over-points">
<h2>Iterating over points<a class="headerlink" href="#iterating-over-points" title="Permalink to this headline">¶</a></h2>
<p>libLAS:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="k">while</span> <span class="p">((</span><span class="n">LAS_point</span> <span class="o">=</span> <span class="n">LASReader_GetNextPoint</span><span class="p">(</span><span class="n">LAS_reader</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>PDAL:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="k">for</span> <span class="p">(</span><span class="n">pdal</span><span class="o">::</span><span class="n">PointId</span> <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="n">point_view</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">idx</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="point-validity">
<h2>Point validity<a class="headerlink" href="#point-validity" title="Permalink to this headline">¶</a></h2>
<p>The correct usage of libLAS required to test point validity:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">LASPoint_IsValid</span><span class="p">(</span><span class="n">LAS_point</span><span class="p">)</span>
</pre></div>
</div>
<p>In PDAL, there is no need to do that and the caller can assume that
all the points provided by PDAL are valid.</p>
</div>
<div class="section" id="coordinates">
<h2>Coordinates<a class="headerlink" href="#coordinates" title="Permalink to this headline">¶</a></h2>
<p>libLAS:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">LASPoint_GetX</span><span class="p">(</span><span class="n">LAS_point</span><span class="p">);</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">LASPoint_GetY</span><span class="p">(</span><span class="n">LAS_point</span><span class="p">);</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">LASPoint_GetZ</span><span class="p">(</span><span class="n">LAS_point</span><span class="p">);</span>
</pre></div>
</div>
<p>In PDAL, point coordinates are one of the dimensions:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="k">using</span> <span class="k">namespace</span> <span class="n">pdal</span><span class="o">::</span><span class="n">Dimension</span><span class="p">;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">X</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">Y</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">Z</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
</pre></div>
</div>
<p>Thanks to <tt class="docutils literal"><span class="pre">using</span> <span class="pre">namespace</span> <span class="pre">pdal::Dimension</span></tt> we can just write <tt class="docutils literal"><span class="pre">Id::X</span></tt> etc.</p>
</div>
<div class="section" id="returns">
<h2>Returns<a class="headerlink" href="#returns" title="Permalink to this headline">¶</a></h2>
<p>libLAS:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="kt">int</span> <span class="n">return_no</span> <span class="o">=</span> <span class="n">LASPoint_GetReturnNumber</span><span class="p">(</span><span class="n">LAS_point</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">n_returns</span> <span class="o">=</span> <span class="n">LASPoint_GetNumberOfReturns</span><span class="p">(</span><span class="n">LAS_point</span><span class="p">);</span>
</pre></div>
</div>
<p>PDAL:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="kt">int</span> <span class="n">return_no</span> <span class="o">=</span> <span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">ReturnNumber</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">n_returns</span> <span class="o">=</span> <span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">NumberOfReturns</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<p>libLAS:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="kt">int</span> <span class="n">point_class</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">LASPoint_GetClassification</span><span class="p">(</span><span class="n">LAS_point</span><span class="p">);</span>
</pre></div>
</div>
<p>PDAL:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="kt">int</span> <span class="n">point_class</span> <span class="o">=</span> <span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">Classification</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="color">
<h2>Color<a class="headerlink" href="#color" title="Permalink to this headline">¶</a></h2>
<p>libLAS:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">LASColorH</span> <span class="n">LAS_color</span> <span class="o">=</span> <span class="n">LASPoint_GetColor</span><span class="p">(</span><span class="n">LAS_point</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">red</span> <span class="o">=</span> <span class="n">LASColor_GetRed</span><span class="p">(</span><span class="n">LAS_color</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">green</span> <span class="o">=</span> <span class="n">LASColor_GetGreen</span><span class="p">(</span><span class="n">LAS_color</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">blue</span> <span class="o">=</span> <span class="n">LASColor_GetBlue</span><span class="p">(</span><span class="n">LAS_color</span><span class="p">);</span>
</pre></div>
</div>
<p>PDAL:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="kt">int</span> <span class="n">red</span> <span class="o">=</span> <span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">Red</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">green</span> <span class="o">=</span> <span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">Green</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">blue</span> <span class="o">=</span> <span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">Blue</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
</pre></div>
</div>
<p>For LAS format, <tt class="docutils literal"><span class="pre">hasColor()</span></tt> method of <tt class="docutils literal"><span class="pre">LasHeader</span></tt> to see if the
format supports RGB. However, in general, you can test use
<tt class="docutils literal"><span class="pre">hasDim(Id::Red)</span></tt>, <tt class="docutils literal"><span class="pre">hasDim(Id::Green)</span></tt> and <tt class="docutils literal"><span class="pre">hasDim(Id::Blue)</span></tt>
method calls on the point, to see if the color was defined.</p>
</div>
<div class="section" id="time">
<h2>Time<a class="headerlink" href="#time" title="Permalink to this headline">¶</a></h2>
<p>libLAS:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="kt">double</span> <span class="n">time</span> <span class="o">=</span> <span class="n">LASPoint_GetTime</span><span class="p">(</span><span class="n">LAS_point</span><span class="p">);</span>
</pre></div>
</div>
<p>PDAL:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="kt">double</span> <span class="n">time</span> <span class="o">=</span> <span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">GpsTime</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="other-point-attributes">
<h2>Other point attributes<a class="headerlink" href="#other-point-attributes" title="Permalink to this headline">¶</a></h2>
<p>libLAS:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">LASPoint_GetIntensity</span><span class="p">(</span><span class="n">LAS_point</span><span class="p">)</span>
<span class="n">LASPoint_GetScanDirection</span><span class="p">(</span><span class="n">LAS_point</span><span class="p">)</span>
<span class="n">LASPoint_GetFlightLineEdge</span><span class="p">(</span><span class="n">LAS_point</span><span class="p">)</span>
<span class="n">LASPoint_GetScanAngleRank</span><span class="p">(</span><span class="n">LAS_point</span><span class="p">)</span>
<span class="n">LASPoint_GetPointSourceId</span><span class="p">(</span><span class="n">LAS_point</span><span class="p">)</span>
<span class="n">LASPoint_GetUserData</span><span class="p">(</span><span class="n">LAS_point</span><span class="p">)</span>
</pre></div>
</div>
<p>PDAL:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">Intensity</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
<span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">ScanDirectionFlag</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
<span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">EdgeOfFlightLine</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
<span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">ScanAngleRank</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
<span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">PointSourceId</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
<span class="n">point_view</span><span class="o">-&gt;</span><span class="n">getFieldAs</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Id</span><span class="o">::</span><span class="n">UserData</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="memory-management">
<h2>Memory management<a class="headerlink" href="#memory-management" title="Permalink to this headline">¶</a></h2>
<p>In libLAS C API, we need to explicitly take care of freeing the memory:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">LASSRS_Destroy</span><span class="p">(</span><span class="n">LAS_srs</span><span class="p">);</span>
<span class="n">LASHeader_Destroy</span><span class="p">(</span><span class="n">LAS_header</span><span class="p">);</span>
<span class="n">LASReader_Destroy</span><span class="p">(</span><span class="n">LAS_reader</span><span class="p">);</span>
</pre></div>
</div>
<p>When using C++ and PDAL, the objects created on stack free the memory
when they go out of scope. When using smart pointers, they will take
care of the memory they manage. This does not apply to special cases
such as <tt class="docutils literal"><span class="pre">exit()</span></tt> function calls.</p>
</div>
</div>


                    
                        <div id="disqus_thread"></div>
                        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                    
                </div>
                <div class="span3">
                    
        <div class="sphinxsidebar">
            <div class="sphinxsidebarwrapper">
  <h3><a href="../docs.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">libLAS C API to PDAL transition guide</a><ul>
<li><a class="reference internal" href="#includes">Includes</a></li>
<li><a class="reference internal" href="#initial-steps">Initial steps</a></li>
<li><a class="reference internal" href="#dataset-properties">Dataset properties</a></li>
<li><a class="reference internal" href="#iterating-over-points">Iterating over points</a></li>
<li><a class="reference internal" href="#point-validity">Point validity</a></li>
<li><a class="reference internal" href="#coordinates">Coordinates</a></li>
<li><a class="reference internal" href="#returns">Returns</a></li>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#color">Color</a></li>
<li><a class="reference internal" href="#time">Time</a></li>
<li><a class="reference internal" href="#other-point-attributes">Other point attributes</a></li>
<li><a class="reference internal" href="#memory-management">Memory management</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="writing-writer.html"
                        title="previous chapter">Writing a writer</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../api/index.html"
                        title="next chapter">API documentation for PDAL</a></p>
            </div>
        </div>
                </div>
            
        </div>
    </div>
    <div class="footer">
        
        <div class="container">
                    &copy;
                        <a href="../copyright.html">Copyright</a> 2015, Howard Butler, Michael Gerlek and others
                        .
                Last updated
                    on Oct 22, 2015.
        </div>
    </div>


    <!-- disqus -->
    <script type="text/javascript">
        var disqus_title = 'libLAS C API to PDAL transition guide &mdash; pdal.io';
        var disqus_identifier ='code' + '.' + "pdal" + window.location.pathname.replace('/', '.');
    </script>

    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = "pdal"; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>


<script type="text/javascript">
    $('.nav .active').on('click', function () {
        e.preventDefault()
        $(this).siblings().toggle()
    });
</script>

<!-- plusone -->
<script type="text/javascript">
    (function () {
        var po = document.createElement('script');
        po.type = 'text/javascript';
        po.async = true;
        po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(po, s);
    })();
</script>

<!-- twitter -->
<script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>

</body>
</html>