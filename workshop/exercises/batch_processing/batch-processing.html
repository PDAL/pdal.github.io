


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Batch Processing &mdash; pdal.io</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/breathe.css" type="text/css" />
  

  
        <link rel="author" title="About these documents"
              href="../../../about.html"/>
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="pdal.io" href="../../../index.html"/>
        <link rel="up" title="Exercises" href="../index.html"/>
        <link rel="next" title="Plotting a histogram" href="../python/histogram.html"/>
        <link rel="prev" title="Rasterizing Attributes" href="../analysis/rasterize/rasterize.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> PDAL
          

          
          </a>

          
            
            
              <div class="version">
                1.7.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about.html">About</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../download.html">Download</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quickstart</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../apps/index.html">Applications</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../community.html">Community</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../pipeline.html">Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../stages/readers.html">Readers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../stages/writers.html">Writers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../stages/filters.html">Filters</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../dimensions.html">Dimensions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../python.html">Python</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/index.html">Tutorials</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Workshop</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../agenda.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lidar-introduction.html">Introduction to LiDAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../software.html">Software Installation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Exercises</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../index.html#basic-information">Basic Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#translation">Translation</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#analysis">Analysis</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../analysis/boundary/boundary.html">Finding the boundary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/clipping/clipping.html">Clipping data with polygons</a></li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/colorization/colorization.html">Colorizing points with imagery</a></li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/denoising/denoising.html">Removing noise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/density/density.html">Visualizing acquisition density</a></li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/thinning/thinning.html">Thinning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/ground/ground.html">Identifying ground</a></li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/dtm/dtm.html">Generating a DTM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/rasterize/rasterize.html">Rasterizing Attributes</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Batch Processing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#python">Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#georeferencing">Georeferencing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../capstone.html">Final Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notes.html">Notes</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../project/index.html">Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../copyright.html">License</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">PDAL</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Home</a> &raquo;</li>
      
        <li><a href="../../index.html">Point Cloud Processing and Analysis with PDAL</a> &raquo;</li>
      
        <li><a href="../index.html">Exercises</a> &raquo;</li>
      
    <li>Batch Processing</li>
    <li class="wy-breadcrumbs-aside">
      
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="batch-processing">
<span id="workshop-batch-processing"></span><h1>Batch Processing<a class="headerlink" href="#batch-processing" title="Permalink to this headline">¶</a></h1>
<p>PDAL doesn’t handle matching multiple file inputs except for glob handling for merge operations,
but does allow for command line substitution parameters to make batch processing simpler,
substitutions. Substitutions work with both <a class="reference internal" href="../../../pipeline.html#pipeline"><span class="std std-ref">Pipeline</span></a> operations as well as with
other applications such as <a class="reference internal" href="../../../apps/translate.html#translate-command"><span class="std std-ref">translate</span></a>.</p>
<div class="section" id="operating-system-variations">
<h2>Operating system variations<a class="headerlink" href="#operating-system-variations" title="Permalink to this headline">¶</a></h2>
<p>How substitutions are passed generally depends on the operating system and tools available.
In the unix/linux environments, this is primarily using the <code class="docutils literal"><span class="pre">find</span></code> and <code class="docutils literal"><span class="pre">ls</span></code> programs to get
lists of files (either with directories or just filenames) and the <code class="docutils literal"><span class="pre">xargs</span></code> program to pass
those files to the <a class="reference internal" href="../../../apps/index.html#apps"><span class="std std-ref">Applications</span></a> application (although <cite>-exec</cite> with <code class="docutils literal"><span class="pre">find</span></code> can also be used). These
tools are available in the <cite>docker</cite> environment if you are running <cite>PDAL</cite> under docker. They
are also available under Windows one installs <cite>Cygwin</cite> or <cite>MinGW</cite>. They are also available if
Git for Windows is installed. They are also available as win32 command line programs installed
from the GNU Findutils (<a class="reference external" href="https://www.gnu.org/software/findutils/findutils.html">https://www.gnu.org/software/findutils/findutils.html</a>).</p>
</div>
<div class="section" id="windows-native-tools">
<h2>Windows native tools<a class="headerlink" href="#windows-native-tools" title="Permalink to this headline">¶</a></h2>
<p>Subtitions can be handled directly in windows using <a class="reference external" href="https://docs.microsoft.com/en-us/powershell/scripting/powershell-scripting?view=powershell-6">PowerShell</a> syntax.</p>
<p>While there are a number of ways to generate lists of files, the <cite>Get-ChildItem</cite> is used here,
along with the <cite>foreach</cite> option to pass each separate filepath to the pdal application.</p>
</div>
<div class="section" id="example-batch-compression-of-las-files-to-laz">
<h2>Example - Batch compression of LAS files to LAZ:<a class="headerlink" href="#example-batch-compression-of-las-files-to-laz" title="Permalink to this headline">¶</a></h2>
<p>To compress a series of LAS files in one directory into compressed LAZ files in another
directory, the <a class="reference external" href="https://docs.microsoft.com/en-us/powershell/scripting/powershell-scripting?view=powershell-6">PowerShell</a> syntax would be:</p>
<div class="highlight-ps1"><div class="highlight"><pre><span></span><span class="nb">Get-ChildItem</span> <span class="p">.\</span><span class="n">DIR1</span><span class="p">\*.</span><span class="n">las</span> <span class="p">|</span> <span class="k">foreach</span> <span class="p">{</span><span class="n">pdal</span> <span class="n">translate</span> <span class="n">-i</span> <span class="p">.\</span><span class="n">DIR1</span><span class="p">\$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">BaseName</span><span class="p">).</span><span class="n">las</span> <span class="n">-o</span> <span class="p">.\</span><span class="n">DIR2</span><span class="p">\$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">BaseName</span><span class="p">).</span><span class="n">laz</span><span class="p">}</span>
</pre></div>
</div>
<p>Note the use of the <cite>$($_.BaseName)</cite> syntax for the files passed. This option on the <cite>$($_)</cite> shortcut for
the full filename, removes the directory and the extension on the file and allows the user to set
the path and extension manually.</p>
<p>The resulting 4 DTMs in <a class="reference external" href="https://qgis.org">QGIS</a> look like:</p>
<a class="reference external image-reference" href="../../images/dtm-batch-result.png"><img alt="../../../_images/dtm-batch-result.png" src="../../../_images/dtm-batch-result.png" /></a>
</div>
<div class="section" id="example-parallel-batch-compression-of-las-files-to-laz">
<h2>Example - Parallel Batch compression of LAS files to LAZ:<a class="headerlink" href="#example-parallel-batch-compression-of-las-files-to-laz" title="Permalink to this headline">¶</a></h2>
<p>This use of the <cite>PowerShell</cite> syntax doesn’t allow a user to execute more than one process at a
time. There is a free download of the <cite>xargs</cite> program that provides parallel execution available
at <a class="reference external" href="http://www.pirosa.co.uk/demo/wxargs/ppx2.exe">http://www.pirosa.co.uk/demo/wxargs/ppx2.exe</a>. For this tool, the file names are passed with
using the <cite>{}</cite> syntax.</p>
<div class="highlight-ps1"><div class="highlight"><pre><span></span><span class="nb">Get-ChildItem</span> <span class="p">.\</span><span class="n">dir1</span><span class="p">\</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-ExpandProperty</span> <span class="n">BaseName</span> <span class="p">|</span> <span class="p">.\</span><span class="n">ppx2</span><span class="p">.</span><span class="n">exe</span> <span class="n">-P</span> <span class="n">3</span> <span class="n">pdal</span> <span class="n">translate</span> <span class="n">-i</span> <span class="s2">&quot;.\dir1\{}.las&quot;</span> <span class="n">-o</span> <span class="s2">&quot;.\dir2\{}.laz&quot;</span><span class="p">`</span>
</pre></div>
</div>
</div>
<div class="section" id="exercise-pipeline-substitions">
<h2>Exercise - Pipeline Substitions:<a class="headerlink" href="#exercise-pipeline-substitions" title="Permalink to this headline">¶</a></h2>
<p>For the most flexibility, pipelines are used to apply a series of opertations to a file (or group
of files). In this excersise, we build on the <a class="reference internal" href="../analysis/dtm/dtm.html#workshop-dtm"><span class="std std-ref">Generating a DTM</span></a> pipeline example, but run this pipline over 4 files and
reproject, calculate a bare earth using the <a class="reference internal" href="../../../stages/filters.smrf.html#filters-smrf"><span class="std std-ref">filters.smrf</span></a> filter, remove those points that aren’t bare earth
with <a class="reference internal" href="../../../stages/filters.range.html#filters-range"><span class="std std-ref">filters.range</span></a> and then write the output using the <a class="reference internal" href="../../../stages/writers.gdal.html#writers-gdal"><span class="std std-ref">writers.gdal</span></a>.</p>
<p>The pipeline we are using is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;pipeline&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;readers.las&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;filters.reprojection&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>  
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;filters.smrf&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;filters.range&quot;</span><span class="p">,</span>
            <span class="s2">&quot;limits&quot;</span><span class="p">:</span><span class="s2">&quot;Classification[2:2]&quot;</span>

        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;gdaldriver&quot;</span><span class="p">:</span><span class="s2">&quot;GTiff&quot;</span><span class="p">,</span>
            <span class="s2">&quot;output_type&quot;</span><span class="p">:</span><span class="s2">&quot;idw&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span> <span class="p">:</span><span class="s2">&quot;2.0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;writers.gdal&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You might have spotted that this pipeline doesn’t have any input or output file references, or a value for the
output spatial reference. We will be adding those at the command line, not within the actual pipeline and
using the substitutions syntax to do this.</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span></span><span class="gp">$</span>env:PATH<span class="o">=</span><span class="s2">&quot;</span><span class="nv">$PATH</span><span class="s2">;C:\OSGeo4W64\bin\&quot;</span>
<span class="gp">$</span><span class="s2">env:GDAL_DATA=&quot;</span>C:<span class="se">\O</span>SGeo4W64<span class="se">\s</span>hare<span class="se">\g</span>dal<span class="se">\&quot;</span>

<span class="go">PS C:\Users\hobu\exercises\batch&gt; Get-ChildItem  C:\Users\administrator\exercises\batch\ll\*.laz | foreach {pdal pipeline C:\Users\hobu\exercises\batch\batch_srs_gdal.json --readers.las.filename=.\ll\$($_.BaseName).laz --writers.gdal.filename=.\dtm\$($_.BaseName).tif --filters.reprojection.out_srs=epsg:26919}</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../python/histogram.html" class="btn btn-neutral float-right" title="Plotting a histogram" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../analysis/rasterize/rasterize.html" class="btn btn-neutral" title="Rasterizing Attributes" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
                    &copy;  2018
                        <a href="https://github.com/abellgithub">Andrew Bell</a>,
                        <a href="https://github.com/chambbj">Brad Chambers</a>,
                        <a href="http://github.com/hobu">Howard Butler</a>,
                        <a href="http://github.com/mpgerlek">Michael Gerlek</a>,
                        and
                        <a href="https://github.com/PDAL/PDAL/graphs/contributors">others</a>.
      Last updated on May 10, 2018.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.7.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
    <div class="footer">
        <div class="container">
                    &copy;  2018
                        <a href="http://github.com/hobu">Howard Butler</a>,
                        <a href="http://github.com/mpgerlek">Michael Gerlek</a>,
                        and
                        <a href="https://github.com/PDAL/PDAL/graphs/contributors">others</a>,
                Last updated
                    on May 10, 2018.
        </div>
    </div>

</body>
</html>